module pixel_filter (
    input wire [11:0] pixel_in,  // rddata R4:G4:B4
    input wire [17:0] sw,        // 1 - brightnessï¼Œ2 - threshold
    output reg [11:0] pixel_out
);

    // Brightness adjust parameter
    parameter BRIGHTNESS_ADJUST = 4'd2; 

    always @(*) begin
        if (sw[0] == 1)  begin
            // Threshold operation
            if ((pixel_in[11:8] + pixel_in[7:4] + pixel_in[3:0]) > 12'h600) begin
                pixel_out = 12'hFFF;  // white
            end else begin
                pixel_out = 12'h000;  // black
            end
        end 
		  
		  if (sw[1] == 1) begin
            // Brightness adj
            pixel_out[11:8] = (pixel_in[11:8] + BRIGHTNESS_ADJUST > 4'hF) ? 4'hF : pixel_in[11:8] + BRIGHTNESS_ADJUST; // R
            pixel_out[7:4]  = (pixel_in[7:4]  + BRIGHTNESS_ADJUST > 4'hF) ? 4'hF : pixel_in[7:4]  + BRIGHTNESS_ADJUST; // G
            pixel_out[3:0]  = (pixel_in[3:0]  + BRIGHTNESS_ADJUST > 4'hF) ? 4'hF : pixel_in[3:0]  + BRIGHTNESS_ADJUST; // B
        end 
    end
endmodule
